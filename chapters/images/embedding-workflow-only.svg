<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 720 420">
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#444"/>
    </marker>
  </defs>

  <!-- Embedding Workflow -->
  <rect x="20" y="10" width="680" height="400" rx="8" fill="#f8fafc" stroke="#64748b" stroke-width="2"/>
  <text x="35" y="33" font-family="system-ui, sans-serif" font-size="13" font-weight="600" fill="#334155">Embedding Workflow</text>

  <!-- Index Time -->
  <rect x="40" y="50" width="647" height="165" rx="6" fill="#dcfce7" stroke="#16a34a" stroke-width="1.5"/>
  <text x="55" y="70" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#166534">Index Time (once per item)</text>

  <rect x="55" y="83" width="100" height="38" rx="4" fill="#fff" stroke="#666"/>
  <text x="105" y="98" font-family="system-ui, sans-serif" font-size="11" text-anchor="middle">Raw Data</text>
  <text x="105" y="111" font-family="system-ui, sans-serif" font-size="9" text-anchor="middle" fill="#666">text, images...</text>

  <line x1="155" y1="102" x2="185" y2="102" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)"/>

  <rect x="187" y="83" width="100" height="38" rx="4" fill="#fff" stroke="#666"/>
  <text x="237" y="98" font-family="system-ui, sans-serif" font-size="11" text-anchor="middle">Encoder</text>
  <text x="237" y="111" font-family="system-ui, sans-serif" font-size="9" text-anchor="middle" fill="#666">BERT, CLIP...</text>

  <line x1="287" y1="102" x2="317" y2="102" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)"/>

  <rect x="319" y="83" width="100" height="38" rx="4" fill="#fff" stroke="#666"/>
  <text x="369" y="106" font-family="system-ui, sans-serif" font-size="11" text-anchor="middle">Embeddings</text>

  <!-- Arrow from Embeddings down to Vector DB -->
  <line x1="369" y1="121" x2="369" y2="153" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Arrow from Raw Data down then across to Document Store -->
  <line x1="104" y1="121" x2="104" y2="141" stroke="#444" stroke-width="1.5"/>
  <line x1="104" y1="141" x2="599" y2="141" stroke="#444" stroke-width="1.5"/>
  <line x1="599" y1="141" x2="599" y2="154" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Vector Database -->
  <rect x="289" y="155" width="160" height="50" rx="25" fill="#fff" stroke="#444" stroke-width="2"/>
  <text x="369" y="177" font-family="system-ui, sans-serif" font-size="11" text-anchor="middle" font-weight="500">Vector Database</text>
  <text x="369" y="192" font-family="system-ui, sans-serif" font-size="9" text-anchor="middle" fill="#666">vectors + doc IDs</text>

  <!-- Document Store -->
  <rect x="525" y="156" width="140" height="50" rx="6" fill="#fef3c7" stroke="#d97706" stroke-width="1.5"/>
  <text x="595" y="178" font-family="system-ui, sans-serif" font-size="11" text-anchor="middle" font-weight="500">Document Store</text>
  <text x="595" y="193" font-family="system-ui, sans-serif" font-size="9" text-anchor="middle" fill="#666">original content</text>

  <!-- Query Time -->
  <rect x="40" y="225" width="647" height="170" rx="6" fill="#dbeafe" stroke="#2563eb" stroke-width="1.5"/>
  <text x="55" y="245" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#1e40af">Query Time (per request)</text>

  <!-- Original Content box (in Query Time area) -->
  <rect x="547" y="251" width="115" height="50" rx="4" fill="#fff" stroke="#666"/>
  <text x="604" y="271" font-family="system-ui, sans-serif" font-size="11" text-anchor="middle">Original Content</text>
  <text x="604" y="286" font-family="system-ui, sans-serif" font-size="9" text-anchor="middle" fill="#666">fetched by ID</text>

  <!-- Query Time flow -->
  <rect x="56" y="331" width="80" height="38" rx="4" fill="#fff" stroke="#666"/>
  <text x="96" y="354" font-family="system-ui, sans-serif" font-size="11" text-anchor="middle">Query</text>

  <line x1="136" y1="350" x2="166" y2="350" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)"/>

  <rect x="168" y="331" width="100" height="38" rx="4" fill="#fff" stroke="#666"/>
  <text x="218" y="346" font-family="system-ui, sans-serif" font-size="11" text-anchor="middle">Encoder</text>
  <text x="218" y="359" font-family="system-ui, sans-serif" font-size="9" text-anchor="middle" fill="#666">(same model)</text>

  <line x1="268" y1="350" x2="298" y2="350" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)"/>

  <rect x="300" y="331" width="100" height="38" rx="4" fill="#fff" stroke="#666"/>
  <text x="350" y="354" font-family="system-ui, sans-serif" font-size="11" text-anchor="middle">Query Embedding</text>

  <line x1="400" y1="350" x2="430" y2="350" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)"/>

  <rect x="432" y="331" width="100" height="38" rx="4" fill="#fff" stroke="#666"/>
  <text x="482" y="354" font-family="system-ui, sans-serif" font-size="11" text-anchor="middle">Search</text>

  <line x1="532" y1="350" x2="549" y2="350" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)"/>

  <rect x="551" y="331" width="115" height="38" rx="4" fill="#fff" stroke="#666"/>
  <text x="608" y="346" font-family="system-ui, sans-serif" font-size="11" text-anchor="middle">Top-K IDs</text>
  <text x="608" y="359" font-family="system-ui, sans-serif" font-size="9" text-anchor="middle" fill="#666">+ similarity scores</text>

  <!-- Arrow from Top-K IDs up to Document Store -->
  <line x1="608" y1="331" x2="608" y2="310" stroke="#444" stroke-width="1.5"/>
  <line x1="608" y1="310" x2="680" y2="310" stroke="#444" stroke-width="1.5"/>
  <line x1="680" y1="310" x2="680" y2="181" stroke="#444" stroke-width="1.5"/>
  <line x1="680" y1="181" x2="667" y2="181" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Arrow from Document Store down to Original Content -->
  <line x1="601" y1="206" x2="601" y2="249" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Arrow from Vector DB to ANN Search -->
  <line x1="449" y1="180" x2="482" y2="180" stroke="#444" stroke-width="1.5"/>
  <line x1="482" y1="180" x2="482" y2="329" stroke="#444" stroke-width="1.5" marker-end="url(#arrow)"/>
</svg>
