<footer class="book-footer" style="margin-top: 2rem; padding: 1rem 0; border-top: 1px solid #dee2e6; font-size: 0.875rem; color: #6c757d;">
  <div style="display: flex; justify-content: space-between; align-items: center;">
    <div>Built from commit: <code>$git-commit$</code></div>
    <div>Â© 2025 Chris Snow</div>
  </div>
</footer>

<script>
// Add anchor links to h1 chapter headings (Quarto only adds them to h2+ by default)
// Uses the stable {#sec-xxx} ids, NOT auto-generated ids from heading text
document.addEventListener('DOMContentLoaded', function() {
  // Find all h1 elements
  var h1Elements = document.querySelectorAll('h1');

  h1Elements.forEach(function(h1) {
    // Skip if already has anchored class (like Preface) - Quarto already handles these
    if (h1.classList.contains('anchored')) {
      return;
    }

    // Skip if already has an anchor link
    if (h1.querySelector('.anchor-section-link')) {
      return;
    }

    // For chapter pages, the id is on a child span.quarto-section-identifier
    // This is the STABLE id from {#sec-xxx} in the source, not auto-generated
    var sectionIdSpan = h1.querySelector('.quarto-section-identifier[id]');
    var id = sectionIdSpan ? sectionIdSpan.id : null;

    // Fallback: check other sources
    if (!id) {
      id = h1.id ||
           h1.getAttribute('data-anchor-id') ||
           (h1.parentElement && h1.parentElement.id) ||
           (h1.closest('section[id]') && h1.closest('section[id]').id);
    }

    if (id) {
      // Add custom class for styling (NOT 'anchored' which triggers AnchorJS)
      h1.classList.add('has-stable-anchor');

      // Create the anchor link element
      var anchor = document.createElement('a');
      anchor.href = '#' + id;
      anchor.className = 'anchor-section-link stable-anchor';
      anchor.setAttribute('aria-label', 'Anchor');
      anchor.innerHTML = '&#128279;'; // Unicode link symbol

      // Append the anchor to the h1
      h1.appendChild(anchor);
    }
  });
});
</script>
